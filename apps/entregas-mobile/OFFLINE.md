# Sistema Offline - App de Entregas

## 📱 Como Funciona

O app de entregas agora funciona **completamente offline**, igual ao WhatsApp! Você pode:

- ✅ **Pré-carregar dados** quando estiver online
- ✅ **Trabalhar offline** sem perder funcionalidades
- ✅ **Registrar entregas** mesmo sem internet
- ✅ **Sincronizar automaticamente** quando voltar online

## 🔄 Funcionamento Automático

### Quando Online:
1. **Download automático**: Dados são baixados e salvos localmente
2. **Cache inteligente**: Rotas, escolas e itens ficam disponíveis offline
3. **Sincronização**: Operações pendentes são enviadas automaticamente

### Quando Offline:
1. **Dados locais**: Usa informações salvas no cache
2. **Fila de operações**: Entregas ficam na fila para sincronizar
3. **Indicadores visuais**: Mostra status offline e operações pendentes

### Quando Volta Online:
1. **Sincronização automática**: Envia todas as operações pendentes
2. **Atualização de dados**: Baixa informações mais recentes
3. **Notificações**: Confirma que tudo foi sincronizado

## 🎯 Funcionalidades Offline

### ✅ O que funciona offline:
- Visualizar rotas e escolas
- Ver detalhes dos itens para entrega
- Confirmar entregas (fica na fila)
- Cancelar entregas (fica na fila)
- Tirar fotos de comprovante
- Navegar entre telas

### ❌ O que precisa de internet:
- Login inicial
- Primeira sincronização de dados
- Estatísticas em tempo real
- Upload de fotos para servidor

## 📊 Gerenciamento do Cache

### Tela de Configurações Offline:
- **Status da conexão**: Online/Offline/Sincronizando
- **Informações do cache**: Tamanho e última sincronização
- **Operações pendentes**: Quantas entregas aguardam sincronização
- **Ações manuais**: Sincronizar agora, limpar cache

### Acesso:
`Perfil → Configurações Offline`

## 🔧 Indicadores Visuais

### Status de Conectividade:
- 🟢 **Online**: Conectado e sincronizado
- 🟡 **Sincronizando**: Enviando operações pendentes
- 🔴 **Offline**: Sem conexão, usando cache local

### Na Tela de Detalhes da Escola:
- 📶 **Modo Offline**: Indica que está trabalhando offline
- 🔄 **X operações pendentes**: Mostra quantas entregas aguardam sincronização

## 💾 Armazenamento Local

### O que é salvo:
- **Rotas**: Lista completa de rotas de entrega
- **Escolas**: Informações de todas as escolas por rota
- **Itens**: Produtos para entrega de cada escola
- **Operações**: Fila de entregas confirmadas/canceladas offline
- **Fotos**: Comprovantes salvos localmente

### Limpeza automática:
- Cache é atualizado automaticamente quando online
- Operações são removidas após sincronização bem-sucedida
- Dados antigos são substituídos por versões mais recentes

## 🚀 Fluxo de Trabalho Recomendado

### 1. Preparação (Online):
```
1. Abrir o app conectado à internet
2. Ir em "Perfil → Configurações Offline"
3. Clicar em "Pré-carregar Dados para Offline"
4. Aguardar o download completo (todas as rotas, escolas e itens)
5. Verificar se os dados estão salvos no cache
```

### 2. Trabalho de Campo (Pode ser Offline):
```
1. Ir para as escolas fazer entregas
2. Confirmar entregas normalmente (mesmo sem internet)
3. Observar indicadores de "operações pendentes"
```

### 3. Sincronização (Online):
```
1. Conectar à internet
2. App sincroniza automaticamente
3. Verificar se todas as operações foram enviadas
```

## ⚠️ Importante

### Primeira Vez:
- **Sempre conecte à internet primeiro** para baixar os dados iniciais
- Navegue pelas rotas/escolas para garantir que tudo seja baixado

### Bateria e Armazenamento:
- O app salva dados localmente (usa espaço do celular)
- Fotos ficam salvas até serem enviadas
- Cache pode ser limpo nas configurações se necessário

### Sincronização:
- **Automática**: Acontece quando volta online
- **Manual**: Pode forçar nas "Configurações Offline"
- **Tentativas**: Sistema tenta 3 vezes antes de desistir

## 🔍 Solução de Problemas

### "Dados não disponíveis offline":
- Conecte à internet e navegue pelas telas para baixar dados
- Vá em "Configurações Offline" → "Sincronizar Todos os Dados"

### Operações não sincronizando:
- Verifique a conexão com internet
- Vá em "Configurações Offline" → "Enviar Operações Pendentes"
- Se persistir, entre em contato com suporte

### Cache muito grande:
- Vá em "Configurações Offline" → "Limpar Cache"
- **Atenção**: Precisará estar online para usar o app novamente

## 📞 Suporte

Em caso de problemas com o sistema offline:
1. Verifique as "Configurações Offline"
2. Tente sincronizar manualmente
3. Se necessário, limpe o cache e sincronize novamente
4. Entre em contato com a equipe de TI

---

**💡 Dica**: O sistema foi projetado para funcionar como o WhatsApp - você pode usar normalmente e ele cuida da sincronização automaticamente!